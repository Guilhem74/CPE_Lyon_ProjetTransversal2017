C51 COMPILER V9.52.0.0   LIB_PROJET_T_CLOCK                                                02/28/2017 09:56:15 PAGE 1   


C51 COMPILER V9.52.0.0, COMPILATION OF MODULE LIB_PROJET_T_CLOCK
OBJECT MODULE PLACED IN LIB_PROJET_T_Clock.OBJ
COMPILER INVOKED BY: D:\Programmes\Keil\C51\BIN\C51.EXE LIB_PROJET_T_Clock.c BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          /*---------------------------------------------------------------------------
   2          ;
   3          ;
   4          ;
   5          ;
   6          ;   FILE NAME   : LIB_BSE_Clock
   7          ;   TARGET MCUs : C8051F020, 
   8          ;   DESCRIPTION : Fonctions Bas niveau pour le TP EMBARQUE
   9          ;
  10          ;   REVISION 1.0
  11          ;
  12          ;---------------------------------------------------------------------------*/
  13          //-------------------------------------------------------------------------
  14          // Includes
  15          //------------------------------------------------------------------------------------
  16          #include <c8051f020.h>                    // SFR declarations
  17          #include "LIB_PROJET_T_Clock.h"
  18          
  19          //*****************************************************************************  
  20          //CFG_Clock
  21          //
  22          //   Cette fonction a pour but de regrouper les fonctions de configurations de l'horloge systeme.
  23          // 
  24          //*****************************************************************************
  25          void CFG_Clock(void)
  26          {
  27   1        Set_Crystal_22();//Set oscillator extern as system clock on 22.1164MHz
  28   1        Enable_Clock_on_pin();//Test
  29   1        Disable_int_oscill();
  30   1      }
  31          
  32          //*****************************************************************************  
  33          //Use_ext_oscill
  34          //
  35          //   Cette fonction a pour but d'activer l'utilisation de l'oscillateur externe comme horloge système.
  36          // 
  37          //*****************************************************************************
  38          void Use_ext_oscill(void)
  39          {
  40   1        OSCICN|=0x08;
  41   1      }
  42          
  43          
  44          
  45          //*****************************************************************************  
  46          //Disable_int_oscill
  47          //
  48          //   Cette fonction a pour but de desactiver l'oscillateur interne.
  49          // 
  50          //*****************************************************************************
  51          void Disable_int_oscill(void)
  52          {
  53   1        OSCICN&=~(0x06);
  54   1      }
  55          
C51 COMPILER V9.52.0.0   LIB_PROJET_T_CLOCK                                                02/28/2017 09:56:15 PAGE 2   

  56          
  57          ////////////////////////////////////////OSC_EXTERNE : OSCXCN
  58          
  59          //*****************************************************************************  
  60          //Set_Crystal_22
  61          //
  62          //   Cette fonction a pour but de paramétrer l'horloge système sur un quartz de 22.1184 Mhz.
  63          // 
  64          //*****************************************************************************
  65          void Set_Crystal_22(void)
  66          {
  67   1        OSCXCN=0x67;
  68   1        while(((OSCXCN&0x80)>>7)!=1);//Waiting for crystal oscillator is running and stable
  69   1        Use_ext_oscill();
  70   1        
  71   1      }
  72          //*****************************************************************************  
  73          //Enable_Clock_on_pin
  74          //
  75          //   Cette fonction de test permet de vérifier la valeur de l'horloge système sur un pin.
  76          // 
  77          //*****************************************************************************
  78          void Enable_Clock_on_pin(void)
  79          {
  80   1        XBR2|=0x40;//Enable crossbar to watch sysclock on pin
  81   1        XBR1|=0x80;//Use sysclock on first pin available
  82   1      }
  83          
  84          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     44    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
